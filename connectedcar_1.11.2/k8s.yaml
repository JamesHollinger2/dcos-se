apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: uiservice
spec:
  replicas: 1
  template:
    metadata:
      name: uiservice
      labels:
        app: uiservice
    spec:
      containers:
      - name: uiservice
        image: mesosphere/dcosappstudio:dcosappstudio-uiservice-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDIR
          value: /opt/app
        ports:
        - containerPort: 3024
---
kind: Service
apiVersion: v1
metadata:
  name: uiservice
spec:
  selector:
    app: uiservice
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3024
      nodePort: 31111
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: ui
spec:
  replicas: 1
  template:
    metadata:
      name: ui
      labels:
        app: ui
    spec:
      containers:
      - name: ui
        image: mesosphere/dcosappstudio:dcosappstudio-ui-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: LISTENER
          value: http://messagelistener/data
        - name: KAFKA_SERVICE
          value: master.mesos:2181/dcos-service-prod__dataservices__kafka
        - name: CASSANDRA_SERVICE
          value: node.proddataservicescassandra.l4lb.thisdcos.directory:9042
        - name: PUBLICNODE
          value: $PUBLICNODEIP
        - name: UISERVICE
          value: http://uiservice
        - name: CLUSTER_URL
          value: CLUSTER_URL_TOKEN
        - name: APPDIR
          value: /opt/app
        - name: DASHBOARDURL
          value: /app/kibana#/dashboard/d1?embed=true&_g=(refreshInterval:(display:'10+seconds',pause:!f,section:1,value:10000),time:(from:now-15m,mode:quick,to:now))&_a=(filters:!(),options:(darkTheme:!f),panels:!((col:1,id:'v1',panelIndex:1,row:1,size_x:12,size_y:5,type:visualization),(col:1,id:'v2',panelIndex:2,row:6,size_x:4,size_y:3,type:visualization),(col:5,id:'v3',panelIndex:3,row:6,size_x:4,size_y:4,type:visualization),(col:9,id:'v4',panelIndex:4,row:6,size_x:4,size_y:4,type:visualization)),query:(query_string:(analyze_wildcard:!t,query:'*')),timeRestore:!t,title:'Connected+Car',uiState:(P-1:(mapCenter:!(37.33044712408894,-122.069993019104),mapZoom:14),P-2:(vis:(params:(sort:(columnIndex:3,direction:desc)))),P-3:(vis:(legendOpen:!f))),viewMode:edit)
        ports:
        - containerPort: 3000
        - containerPort: 10500
---
kind: Service
apiVersion: v1
metadata:
  name: ui
spec:
  selector:
    app: ui
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3020
      nodePort: 31110
  type: NodePort
---
kind: Service
apiVersion: v1
metadata:
  name: uisocketio
spec:
  selector:
    app: ui
  ports:
    - protocol: TCP
      port: 80
      targetPort: 10500
      nodePort: 31500
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: loader
spec:
  replicas: 1
  template:
    metadata:
      name: loader
      labels:
        app: loader
    spec:
      containers:
      - name: loader
        image: mesosphere/dcosappstudio:dcosappstudio-loader-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: LISTENER
          value: http://messagelistener/data
        - name: APPDIR
          value: /opt/app
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: loader
spec:
  selector:
    app: loader
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3035
      nodePort: 31112
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: messagetransformer
spec:
  replicas: 1
  template:
    metadata:
      name: messagetransformer
      labels:
        app: messagetransformer
    spec:
      containers:
      - name: messagetransformer
        image: mesosphere/dcosappstudio:dcosappstudio-messagetransformer-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: messagetransformer
spec:
  selector:
    app: messagetransformer
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3032
      nodePort: 31113
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: messagevalidator
spec:
  replicas: 1
  template:
    metadata:
      name: messagevalidator
      labels:
        app: messagevalidator
    spec:
      containers:
      - name: messagevalidator
        image: mesosphere/dcosappstudio:dcosappstudio-messagevalidator-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: messagevalidator
spec:
  selector:
    app: messagevalidator
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3034
      nodePort: 31114
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: messagelistener
spec:
  replicas: 1
  template:
    metadata:
      name: messagelistener
      labels:
        app: messagelistener
    spec:
      containers:
      - name: messagelistener
        image: mesosphere/dcosappstudio:dcosappstudio-messagelistener-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: TRANSFORMER
          value: http://messagetransformer/transform
        - name: VALIDATOR
          value: http://messagevalidator/validate
        - name: KAFKA_BACKEND
          value: http://kafkaingester/data
        - name: CASSANDRA_BACKEND 
          value: http://cassandraingester/data
        - name: ELASTIC_BACKEND
          value: http://elasticingester/data
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: messagelistener
spec:
  selector:
    app: messagelistener
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3030
      nodePort: 31115
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: cassandraingester
spec:
  replicas: 1
  template:
    metadata:
      name: cassandraingester
      labels:
        app: cassandraingester
    spec:
      containers:
      - name: cassandraingester
        image: mesosphere/dcosappstudio:dcosappstudio-cassandraingester-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: CASSANDRA_SERVICE
          value: node.proddataservicescassandra.l4lb.thisdcos.directory:9042
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: cassandraingester
spec:
  selector:
    app: cassandraingester
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3033
      nodePort: 31116
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: kafkaingester
spec:
  replicas: 1
  template:
    metadata:
      name: kafkaingester
      labels:
        app: kafkaingester
    spec:
      containers:
      - name: kafkaingester
        image: mesosphere/dcosappstudio:dcosappstudio-kafkaingester-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: KAFKA_SERVICE
          value: master.mesos:2181/dcos-service-prod__dataservices__kafka
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: kafkaingester
spec:
  selector:
    app: kafkaingester
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3031
      nodePort: 31117
  type: NodePort
---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: elasticingester
spec:
  replicas: 1
  template:
    metadata:
      name: elasticingester
      labels:
        app: elasticingester
    spec:
      containers:
      - name: elasticingester
        image: mesosphere/dcosappstudio:dcosappstudio-elasticingester-v1.11.2-1.5.0
        imagePullPolicy: Always
        env:
        - name: APPDEF
          value: "{'name':'Connected Car Data Platform','showLocation':'true','fields':[{'name':'id','pivot':'false','type':'Long'},{'name':'location','pivot':'false','type':'Location'},{'name':'event_timestamp','pivot':'false','type':'Date/time'},{'name':'batterylevel','pivot':'false','type':'Integer'},{'name':'carid','pivot':'false','type':'Integer'},{'name':'driver','pivot':'false','type':'String'},{'name':'motortemp','pivot':'false','type':'Integer'},{'name':'powerconsumption','pivot':'false','type':'Integer'},{'name':'speed','pivot':'false','type':'Integer'},{'name':'status','pivot':'false','type':'String'}],'transformer':'%09%0A%09%09%0A%09%2F%2F%20Raw%20message%20available%20as%3A%20rawtext%3B%0A%09%2F%2F%20save%20result%20in%20variable%3A%20result%0A%09%2F%2F%20result%20is%20of%20type%20String%0A%09%0A%09%2F%2F%20get%20json%20object%3A%20JSON.parse(rawtext)%3B%0A%09%2F%2F%20also%20available%20fields%5B%5D%20and%20types%5B%5D%3A%0A%09%2F%2F%20e.g.%20fields%5B0%5D%3D%3D%20%22id%22%2C%20%20types%5B0%5D%3D%3D%22Long%22%0A%0A%09%2F%2F%20Transform%20incoming%20xml%20to%20json%3A%20%20json%3D%20parseXML(rawtext)%3B%20result%3D%20JSON.stringify(json)%3B%0A%09%2F%2F%20uses%20npm%20xml2js%0A%09%2F%2F%20Transform%20incoming%20yaml%20to%20json%3A%20let%20json%3DyamlParser.parse(rawtext)%3B%20console.log(%22JSON%3A%20%22%2BJSON.stringify(json))%3B%20result%3D%20JSON.stringify(json)%3B%20%0A%09%2F%2F%20uses%20npm%20yamljs%0A%09%2F%2F%20Rename%20field%3A%20let%20json%3D%20JSON.parse(rawtext)%3B%20json.newname%3D%20json.oldname%3B%20delete%20json.oldname%3B%0A%0A%09console.log(%22In%20%3A%20%22%2Brawtext)%3B%0A%2F*%0A%09let%20json%3D%20JSON.parse(rawtext)%3B%0A%20%20%20%20%20%20%20%20for%20(var%20key%20in%20json)%20%7B%0A%20%20%09%09%09if%20(json.hasOwnProperty(key))%20%7B%0A%09%09%09%09%20%20if(typesByName%5Bkey%5D%3D%3D%3D%20%22String%22)%0A%09%09%09%09%20%20%09json%5Bkey%5D%3D%20%22Great!%22%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09result%3D%20JSON.stringify(json)%3B%0A*%2F%0A%09result%3D%20rawtext%3B%0A%09console.log(%22After%20transformation%3A%20%22%2Bresult)%3B%0A%09%09%09%09%09%0A%09%09%09%09%09','topic':'connectedcar','table':'connectedcar','keyspace':'connectedcar','path':'connectedcar','creator':'http://localhost:3000','dockerrepo':'mesosphere/dcosappstudio','img':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/bgimg.jpg','vis':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_vis.json','dash':'https://s3-us-west-2.amazonaws.com/mesosphere-demo-connectedcar/kibana_connected_car_dash.json','hideloader':'true'}"
        - name: ELASTIC_SERVICE
          value: http://elastic:changeme@coordinator.proddataserviceselastic.l4lb.thisdcos.directory:9200
        ports:
        - containerPort: 3000
---
kind: Service
apiVersion: v1
metadata:
  name: elasticingester
spec:
  selector:
    app: elasticingester
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3036
      nodePort: 31118
  type: NodePort
